<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FXåç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ | Fintokeiæ”»ç•¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-color: #30363d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --accent-green: #3fb950;
            --accent-red: #f85149;
            --accent-blue: #58a6ff;
            --accent-yellow: #d29922;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
        }

        .card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
        }

        .input-range {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            outline: none;
        }

        .input-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent-blue);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .input-range::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .input-range::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--accent-blue);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .number-input {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            padding: 8px 12px;
            width: 100%;
            outline: none;
            transition: border-color 0.2s;
        }

        .number-input:focus {
            border-color: var(--accent-blue);
        }

        .stat-card {
            background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 16px;
        }

        .positive { color: var(--accent-green); }
        .negative { color: var(--accent-red); }

        .btn {
            background: linear-gradient(135deg, var(--accent-blue) 0%, #1f6feb 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
        }

        .glow-green {
            box-shadow: 0 0 20px rgba(63, 185, 80, 0.2);
        }

        .glow-red {
            box-shadow: 0 0 20px rgba(248, 81, 73, 0.2);
        }

        .tab-btn {
            padding: 12px 24px;
            border-radius: 8px 8px 0 0;
            font-weight: 600;
            transition: all 0.2s;
            border: 1px solid transparent;
            border-bottom: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .tab-btn.active {
            background: var(--bg-secondary);
            color: var(--accent-blue);
            border-color: var(--border-color);
        }

        .drop-zone {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .drop-zone:hover, .drop-zone.drag-over {
            border-color: var(--accent-blue);
            background: rgba(88, 166, 255, 0.05);
        }

        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: var(--bg-tertiary);
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s;
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="app" class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">
                <span class="text-blue-400">FX</span> åç›Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
            </h1>
            <p class="text-gray-400">Fintokeiæ”»ç•¥ç”¨</p>
        </header>

        <!-- Tab Navigation -->
        <div class="flex justify-center mb-6">
            <div class="flex" style="border-bottom: 1px solid var(--border-color);">
                <button @click="activeTab = 'simulator'"
                        :class="['tab-btn', activeTab === 'simulator' ? 'active' : '']">
                    ğŸ“Š ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                </button>
                <button @click="activeTab = 'results'"
                        :class="['tab-btn', activeTab === 'results' ? 'active' : '']">
                    ğŸ“ˆ ãƒˆãƒ¬ãƒ¼ãƒ‰å®Ÿç¸¾
                </button>
            </div>
        </div>

        <!-- Simulator Tab -->
        <div v-show="activeTab === 'simulator'" class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Left Panel - Input Parameters -->
            <div class="lg:col-span-4">
                <div class="card p-6">
                    <h2 class="text-xl font-bold mb-6 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                        </svg>
                        å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
                    </h2>

                    <!-- å£åº§è³‡é‡‘ -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">å£åº§è³‡é‡‘</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.accountBalance"
                                   min="1000000" max="100000000" step="1000000"
                                   class="input-range flex-1">
                            <div class="w-32">
                                <input type="text" :value="formatCurrency(params.accountBalance)"
                                       @input="updateAccountBalance" class="number-input text-right text-sm">
                            </div>
                        </div>
                    </div>

                    <!-- ãƒªã‚¹ã‚¯è¨±å®¹ç‡ -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">ãƒªã‚¹ã‚¯è¨±å®¹ç‡</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.riskRate"
                                   min="0.1" max="3" step="0.1"
                                   class="input-range flex-1">
                            <div class="w-24">
                                <input type="number" v-model.number="params.riskRate"
                                       min="0.1" max="5" step="0.1"
                                       class="number-input text-right text-sm">
                            </div>
                            <span class="text-gray-400 w-6">%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">
                            ğŸ’¡ Fintokeiæ”»ç•¥æ¨å¥¨: <span class="text-blue-400 font-medium">0.8%</span>
                            ï¼ˆé€£æ•—ã—ã¦ã‚‚å¤±æ ¼ã«ãªã‚‰ãªã„å®‰å…¨è¨­å®šï¼‰
                        </p>
                    </div>

                    <!-- ãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰ -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">ãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰ (1:N)</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.riskReward"
                                   min="0.5" max="5" step="0.1"
                                   class="input-range flex-1">
                            <div class="w-24">
                                <input type="number" v-model.number="params.riskReward"
                                       min="0.1" max="10" step="0.1"
                                       class="number-input text-right text-sm">
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">æå¤±1ã«å¯¾ã—ã¦åˆ©ç›Š{{ params.riskReward.toFixed(1) }}</p>
                    </div>

                    <!-- æœˆé–“ã‚¨ãƒ³ãƒˆãƒªãƒ¼å›æ•° -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">æœˆé–“ã‚¨ãƒ³ãƒˆãƒªãƒ¼å›æ•°</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.monthlyTrades"
                                   min="1" max="200" step="1"
                                   class="input-range flex-1">
                            <div class="w-24">
                                <input type="number" v-model.number="params.monthlyTrades"
                                       min="1" max="500" step="1"
                                       class="number-input text-right text-sm">
                            </div>
                            <span class="text-gray-400 w-6">å›</span>
                        </div>
                    </div>

                    <!-- ç´”ç²‹å‹ç‡ -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">ç´”ç²‹å‹ç‡ï¼ˆå»ºå€¤é™¤ãï¼‰</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.winRate"
                                   min="30" max="90" step="0.5"
                                   class="input-range flex-1">
                            <div class="w-24">
                                <input type="number" v-model.number="params.winRate"
                                       min="0" max="100" step="0.5"
                                       class="number-input text-right text-sm">
                            </div>
                            <span class="text-gray-400 w-6">%</span>
                        </div>
                    </div>

                    <!-- å»ºå€¤æ’¤é€€ç‡ -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">å»ºå€¤æ’¤é€€ç‡</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.breakEvenRate"
                                   min="0" max="80" step="1"
                                   class="input-range flex-1">
                            <div class="w-24">
                                <input type="number" v-model.number="params.breakEvenRate"
                                       min="0" max="90" step="1"
                                       class="number-input text-right text-sm">
                            </div>
                            <span class="text-gray-400 w-6">%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">å»ºå€¤æ’¤é€€ãŒå¤šã„ã»ã©ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³è»½æ¸›</p>
                    </div>

                    <!-- åˆ©ç›Šé…åˆ†ç‡ -->
                    <div class="mb-6">
                        <label class="block text-sm text-gray-400 mb-2">åˆ©ç›Šé…åˆ†ç‡ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼å–ã‚Šåˆ†ï¼‰</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.profitShare"
                                   min="50" max="100" step="5"
                                   class="input-range flex-1">
                            <div class="w-24">
                                <input type="number" v-model.number="params.profitShare"
                                       min="0" max="100" step="5"
                                       class="number-input text-right text-sm">
                            </div>
                            <span class="text-gray-400 w-6">%</span>
                        </div>
                    </div>

                    <!-- Simulate Button -->
                    <button @click="runSimulation" class="btn w-full mt-4">
                        <span class="flex items-center justify-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                            ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                        </span>
                    </button>
                </div>

                <!-- Fintokei Simulation -->
                <div class="card p-6 mt-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                        </svg>
                        Fintokei åˆæ ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                        <span class="ml-2 text-xs text-gray-500">({{ fintokeiMonte.iterations }}å›è©¦è¡Œ)</span>
                    </h3>

                    <!-- æœˆé–“å–å¼•æ—¥æ•° -->
                    <div class="mb-4">
                        <label class="block text-sm text-gray-400 mb-2">æœˆé–“å–å¼•æ—¥æ•°</label>
                        <div class="flex items-center gap-3">
                            <input type="range" v-model.number="params.tradingDaysPerMonth"
                                   min="5" max="25" step="1"
                                   class="input-range flex-1">
                            <div class="w-20">
                                <input type="number" v-model.number="params.tradingDaysPerMonth"
                                       min="1" max="30" step="1"
                                       class="number-input text-right text-sm">
                            </div>
                            <span class="text-gray-400 w-6">æ—¥</span>
                        </div>
                    </div>

                    <!-- ç·åˆæˆåŠŸç‡ -->
                    <div class="mb-4 p-4 rounded-lg" :style="{
                        background: fintokeiMonte.totalSuccessRate >= 70 ? 'rgba(34, 197, 94, 0.15)' :
                                   fintokeiMonte.totalSuccessRate >= 40 ? 'rgba(250, 204, 21, 0.15)' : 'rgba(248, 81, 73, 0.15)',
                        border: fintokeiMonte.totalSuccessRate >= 70 ? '1px solid rgba(34, 197, 94, 0.4)' :
                               fintokeiMonte.totalSuccessRate >= 40 ? '1px solid rgba(250, 204, 21, 0.4)' : '1px solid rgba(248, 81, 73, 0.4)'
                    }">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium" :class="{
                                'text-green-400': fintokeiMonte.totalSuccessRate >= 70,
                                'text-yellow-400': fintokeiMonte.totalSuccessRate >= 40 && fintokeiMonte.totalSuccessRate < 70,
                                'text-red-400': fintokeiMonte.totalSuccessRate < 40
                            }">ğŸ¯ ç·åˆåˆæ ¼ç‡</span>
                            <span class="text-2xl font-bold" :class="{
                                'text-green-400': fintokeiMonte.totalSuccessRate >= 70,
                                'text-yellow-400': fintokeiMonte.totalSuccessRate >= 40 && fintokeiMonte.totalSuccessRate < 70,
                                'text-red-400': fintokeiMonte.totalSuccessRate < 40
                            }">{{ fintokeiMonte.totalSuccessRate.toFixed(1) }}%</span>
                        </div>
                        <div class="mt-2 h-2 bg-gray-700 rounded-full overflow-hidden">
                            <div class="h-full rounded-full transition-all duration-300"
                                 :style="{ width: fintokeiMonte.totalSuccessRate + '%' }"
                                 :class="{
                                     'bg-green-500': fintokeiMonte.totalSuccessRate >= 70,
                                     'bg-yellow-500': fintokeiMonte.totalSuccessRate >= 40 && fintokeiMonte.totalSuccessRate < 70,
                                     'bg-red-500': fintokeiMonte.totalSuccessRate < 40
                                 }"></div>
                        </div>
                    </div>

                    <!-- Phase Results -->
                    <div class="space-y-3">
                        <!-- ãƒ•ã‚§ãƒ¼ã‚º1 -->
                        <div class="p-3 rounded-lg" style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3);">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-blue-400 text-sm font-medium">ãƒ•ã‚§ãƒ¼ã‚º1 (+8%ç›®æ¨™)</span>
                                <span class="text-blue-300 text-sm">æˆåŠŸç‡: {{ fintokeiMonte.phase1SuccessRate.toFixed(1) }}%</span>
                            </div>
                            <div class="grid grid-cols-3 gap-2 text-center text-xs">
                                <div class="p-2 rounded" style="background: rgba(34, 197, 94, 0.2);">
                                    <p class="text-gray-400">æ¥½è¦³çš„</p>
                                    <p class="text-green-400 font-bold">{{ fintokeiMonte.phase1Optimistic }}æ—¥</p>
                                </div>
                                <div class="p-2 rounded" style="background: rgba(59, 130, 246, 0.2);">
                                    <p class="text-gray-400">å¹³å‡çš„</p>
                                    <p class="text-blue-400 font-bold">{{ fintokeiMonte.phase1Median }}æ—¥</p>
                                </div>
                                <div class="p-2 rounded" style="background: rgba(248, 81, 73, 0.2);">
                                    <p class="text-gray-400">æ‚²è¦³çš„</p>
                                    <p class="text-red-400 font-bold">{{ fintokeiMonte.phase1Pessimistic }}æ—¥</p>
                                </div>
                            </div>
                        </div>

                        <!-- ãƒ•ã‚§ãƒ¼ã‚º2 -->
                        <div class="p-3 rounded-lg" style="background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3);">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-purple-400 text-sm font-medium">ãƒ•ã‚§ãƒ¼ã‚º2 (+6%ç›®æ¨™)</span>
                                <span class="text-purple-300 text-sm">æˆåŠŸç‡: {{ fintokeiMonte.phase2SuccessRate.toFixed(1) }}%</span>
                            </div>
                            <div class="grid grid-cols-3 gap-2 text-center text-xs">
                                <div class="p-2 rounded" style="background: rgba(34, 197, 94, 0.2);">
                                    <p class="text-gray-400">æ¥½è¦³çš„</p>
                                    <p class="text-green-400 font-bold">{{ fintokeiMonte.phase2Optimistic }}æ—¥</p>
                                </div>
                                <div class="p-2 rounded" style="background: rgba(139, 92, 246, 0.2);">
                                    <p class="text-gray-400">å¹³å‡çš„</p>
                                    <p class="text-purple-400 font-bold">{{ fintokeiMonte.phase2Median }}æ—¥</p>
                                </div>
                                <div class="p-2 rounded" style="background: rgba(248, 81, 73, 0.2);">
                                    <p class="text-gray-400">æ‚²è¦³çš„</p>
                                    <p class="text-red-400 font-bold">{{ fintokeiMonte.phase2Pessimistic }}æ—¥</p>
                                </div>
                            </div>
                        </div>

                        <!-- åˆè¨ˆãƒ»å‡ºé‡‘ã¾ã§ -->
                        <div class="p-3 rounded-lg" style="background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3);">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-green-400 text-sm font-medium">åˆæ ¼ã¾ã§ã®åˆè¨ˆï¼ˆæˆåŠŸæ™‚ï¼‰</span>
                            </div>
                            <div class="grid grid-cols-3 gap-2 text-center text-xs">
                                <div class="p-2 rounded" style="background: rgba(34, 197, 94, 0.2);">
                                    <p class="text-gray-400">æ¥½è¦³çš„</p>
                                    <p class="text-green-400 font-bold">{{ fintokeiMonte.totalOptimistic }}æ—¥</p>
                                    <p class="text-gray-500">({{ (fintokeiMonte.totalOptimistic / 30).toFixed(1) }}ãƒ¶æœˆ)</p>
                                </div>
                                <div class="p-2 rounded" style="background: rgba(59, 130, 246, 0.2);">
                                    <p class="text-gray-400">å¹³å‡çš„</p>
                                    <p class="text-blue-400 font-bold">{{ fintokeiMonte.totalMedian }}æ—¥</p>
                                    <p class="text-gray-500">({{ (fintokeiMonte.totalMedian / 30).toFixed(1) }}ãƒ¶æœˆ)</p>
                                </div>
                                <div class="p-2 rounded" style="background: rgba(248, 81, 73, 0.2);">
                                    <p class="text-gray-400">æ‚²è¦³çš„</p>
                                    <p class="text-red-400 font-bold">{{ fintokeiMonte.totalPessimistic }}æ—¥</p>
                                    <p class="text-gray-500">({{ (fintokeiMonte.totalPessimistic / 30).toFixed(1) }}ãƒ¶æœˆ)</p>
                                </div>
                            </div>
                        </div>

                        <!-- å‡ºé‡‘å¯èƒ½æ—¥ -->
                        <div class="p-3 rounded-lg" style="background: rgba(250, 204, 21, 0.1); border: 1px solid rgba(250, 204, 21, 0.3);">
                            <div class="flex justify-between items-center">
                                <span class="text-yellow-400 text-sm font-medium">åˆå›å‡ºé‡‘å¯èƒ½ã¾ã§ï¼ˆå¹³å‡ï¼‰</span>
                                <span class="text-white font-bold">{{ fintokeiMonte.totalMedian + 14 }}æ—¥ (ç´„{{ ((fintokeiMonte.totalMedian + 14) / 30).toFixed(1) }}ãƒ¶æœˆ)</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">ãƒ—ãƒ­èªå®šå¾Œ14æ—¥å¾Œã«å‡ºé‡‘ç”³è«‹å¯èƒ½</p>
                        </div>
                    </div>

                    <!-- å¤±æ ¼ãƒªã‚¹ã‚¯åˆ†æ -->
                    <div class="mt-4 p-3 rounded-lg" style="background: rgba(248, 81, 73, 0.1); border: 1px solid rgba(248, 81, 73, 0.3);">
                        <p class="text-red-400 text-sm font-medium mb-2">âš ï¸ å¤±æ ¼ãƒªã‚¹ã‚¯åˆ†æ</p>
                        <div class="grid grid-cols-2 gap-3 text-xs">
                            <div>
                                <p class="text-gray-400">1æ—¥æœ€å¤§æå¤±ãƒªã‚¹ã‚¯</p>
                                <p class="text-white font-medium">{{ fintokeiMonte.dailyMaxLossPercent.toFixed(2) }}% / 5%</p>
                            </div>
                            <div>
                                <p class="text-gray-400">å¤±æ ¼ç¢ºç‡ï¼ˆç·åˆï¼‰</p>
                                <p class="font-medium" :class="fintokeiMonte.totalSuccessRate >= 70 ? 'text-green-400' : fintokeiMonte.totalSuccessRate >= 40 ? 'text-yellow-400' : 'text-red-400'">
                                    {{ (100 - fintokeiMonte.totalSuccessRate).toFixed(1) }}%
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- æ³¨è¨˜ -->
                    <div class="mt-4 p-3 rounded-lg" style="background: rgba(88, 166, 255, 0.1); border: 1px solid rgba(88, 166, 255, 0.3);">
                        <p class="text-blue-400 text-xs font-medium mb-1">ğŸ“Š ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç²¾åº¦</p>
                        <p class="text-xs text-gray-400 leading-relaxed">
                            ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ä»¥ä¸‹ã®ç¾å®Ÿçš„è¦ç´ ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š<br>
                            â€¢ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ï¼ˆå¹³å‡0.4 pipsï¼‰<br>
                            â€¢ æ‰‹æ•°æ–™ï¼ˆå¾€å¾©6ãƒ‰ãƒ« â‰ˆ 0.006%ï¼‰<br>
                            â€¢ ã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸ï¼ˆ0.01-0.02%ã®ãƒ©ãƒ³ãƒ€ãƒ ï¼‰<br>
                            â€¢ é€£æ•—æ™‚ã®å¿ƒç†çš„å½±éŸ¿ï¼ˆãƒªã‚¹ã‚¯å¾®å¢—ãƒ¢ãƒ‡ãƒ«ï¼‰
                        </p>
                    </div>
                </div>

                <!-- Trade Breakdown -->
                <div class="card p-6 mt-6">
                    <h3 class="text-lg font-bold mb-4 text-gray-300">ãƒˆãƒ¬ãƒ¼ãƒ‰å†…è¨³</h3>
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">ç·ã‚¨ãƒ³ãƒˆãƒªãƒ¼æ•°</span>
                            <span>{{ params.monthlyTrades }}å›</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">å»ºå€¤æ’¤é€€</span>
                            <span class="text-yellow-400">{{ calculated.breakEvenTrades }}å›</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">æœ‰åŠ¹ãƒˆãƒ¬ãƒ¼ãƒ‰</span>
                            <span>{{ calculated.effectiveTrades }}å›</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">å‹ã¡ãƒˆãƒ¬ãƒ¼ãƒ‰</span>
                            <span class="text-green-400">{{ calculated.winTrades }}å›</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">è² ã‘ãƒˆãƒ¬ãƒ¼ãƒ‰</span>
                            <span class="text-red-400">{{ calculated.loseTrades }}å›</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Results -->
            <div class="lg:col-span-8">
                <!-- Summary Cards -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="stat-card" :class="calculated.monthlyProfit >= 0 ? 'glow-green' : 'glow-red'">
                        <p class="text-xs text-gray-400 mb-1">æœˆé–“æ¨å®šåˆ©ç›Š</p>
                        <p class="text-xl font-bold" :class="calculated.monthlyProfit >= 0 ? 'positive' : 'negative'">
                            {{ formatCurrency(calculated.monthlyProfit) }}
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æœˆåˆ©</p>
                        <p class="text-xl font-bold" :class="calculated.monthlyReturn >= 0 ? 'positive' : 'negative'">
                            {{ calculated.monthlyReturn.toFixed(2) }}%
                        </p>
                    </div>
                    <div class="stat-card glow-green">
                        <p class="text-xs text-gray-400 mb-1">ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼æ‰‹å–ã‚Š</p>
                        <p class="text-xl font-bold text-green-400">
                            {{ formatCurrency(calculated.traderIncome) }}
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æç›Šåˆ†å²å‹ç‡</p>
                        <p class="text-xl font-bold" :class="params.winRate >= calculated.breakEvenWinRate ? 'positive' : 'negative'">
                            {{ calculated.breakEvenWinRate.toFixed(1) }}%
                        </p>
                    </div>
                </div>

                <!-- Additional Stats -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">1ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ãŸã‚Šãƒªã‚¹ã‚¯é¡</p>
                        <p class="text-lg font-bold text-blue-400">
                            {{ formatCurrency(calculated.riskPerTrade) }}
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æœŸå¾…å€¤ / ãƒˆãƒ¬ãƒ¼ãƒ‰</p>
                        <p class="text-lg font-bold" :class="calculated.expectedValue >= 0 ? 'positive' : 'negative'">
                            {{ formatCurrency(calculated.expectedValue) }}
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³</p>
                        <p class="text-lg font-bold text-red-400">
                            {{ simulation.maxDrawdownPercent.toFixed(2) }}%
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">ãƒ—ãƒ­ãƒ•ã‚£ãƒƒãƒˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼</p>
                        <p class="text-lg font-bold" :class="calculated.profitFactor >= 1 ? 'positive' : 'negative'">
                            {{ calculated.profitFactor.toFixed(2) }}
                        </p>
                    </div>
                </div>

                <!-- Chart -->
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">è³‡ç”£æ¨ç§»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                        <div class="text-sm text-gray-400">
                            æœ€çµ‚è³‡ç”£: <span class="font-bold" :class="simulation.finalBalance >= params.accountBalance ? 'positive' : 'negative'">
                                {{ formatCurrency(simulation.finalBalance) }}
                            </span>
                        </div>
                    </div>
                    <div class="relative" style="height: 400px;">
                        <canvas ref="chartCanvas"></canvas>
                    </div>
                </div>

                <!-- Risk Analysis -->
                <div class="card p-6 mt-6">
                    <h3 class="text-lg font-bold mb-4">ãƒªã‚¹ã‚¯åˆ†æ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-sm font-semibold text-gray-400 mb-3">å‹ç‡ãƒãƒ¼ã‚¸ãƒ³</h4>
                            <div class="relative h-4 bg-gray-700 rounded-full overflow-hidden">
                                <div class="absolute h-full bg-gradient-to-r from-red-500 via-yellow-500 to-green-500"
                                     style="width: 100%"></div>
                                <div class="absolute h-full w-1 bg-white"
                                     :style="{ left: calculated.breakEvenWinRate + '%' }"></div>
                                <div class="absolute h-full w-2 bg-blue-400 rounded-full"
                                     :style="{ left: params.winRate + '%', transform: 'translateX(-50%)' }"></div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>0%</span>
                                <span>æç›Šåˆ†å²: {{ calculated.breakEvenWinRate.toFixed(1) }}%</span>
                                <span>100%</span>
                            </div>
                            <p class="text-sm mt-2" :class="params.winRate >= calculated.breakEvenWinRate ? 'text-green-400' : 'text-red-400'">
                                ç¾åœ¨ã®å‹ç‡ã¯æç›Šåˆ†å²ç‚¹ã‚’{{ params.winRate >= calculated.breakEvenWinRate ? 'ä¸Šå›ã£ã¦ã„ã¾ã™' : 'ä¸‹å›ã£ã¦ã„ã¾ã™' }}
                                ï¼ˆå·®: {{ (params.winRate - calculated.breakEvenWinRate).toFixed(1) }}%ï¼‰
                            </p>
                        </div>
                        <div>
                            <h4 class="text-sm font-semibold text-gray-400 mb-3">å»ºå€¤æ’¤é€€ã®åŠ¹æœ</h4>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">ãƒªã‚¹ã‚¯è»½æ¸›åŠ¹æœ</span>
                                    <span class="text-yellow-400">
                                        {{ (params.breakEvenRate).toFixed(0) }}%ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã§ãƒªã‚¹ã‚¯0
                                    </span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">æœ‰åŠ¹RRå®Ÿè³ªå€¤</span>
                                    <span class="text-blue-400">
                                        1:{{ ((params.riskReward * params.winRate/100) / ((1 - params.breakEvenRate/100) * (1 - params.winRate/100))).toFixed(2) }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Tab -->
        <div v-show="activeTab === 'results'" class="space-y-6">
            <!-- Google Sheets Integration -->
            <div class="card p-6">
                <h2 class="text-xl font-bold mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æº
                </h2>
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID</label>
                            <input type="text" v-model="googleSheetId" 
                                   placeholder="1WkBTJe7q7c6FhgX7CSYLKrJihwGP0KGFW2n813aLQt4"
                                   class="number-input">
                            <p class="text-xs text-gray-500 mt-1">URLã® /d/ ã¨ /edit ã®é–“ã®æ–‡å­—åˆ—</p>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">ã‚·ãƒ¼ãƒˆå</label>
                            <input type="text" v-model="googleSheetName" 
                                   placeholder="ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒãƒ¼ãƒˆAIåˆ†æç”¨"
                                   class="number-input">
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button @click="loadFromGoogleSheets" 
                                :disabled="isLoadingGoogleSheets"
                                class="btn flex-1">
                            <span class="flex items-center justify-center">
                                <svg v-if="isLoadingGoogleSheets" class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                <svg v-else class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                {{ isLoadingGoogleSheets ? 'èª­ã¿è¾¼ã¿ä¸­...' : 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰èª­ã¿è¾¼ã¿' }}
                            </span>
                        </button>
                        <button v-if="autoRefreshEnabled" @click="toggleAutoRefresh" 
                                class="btn" style="background: linear-gradient(135deg, var(--accent-green) 0%, #2ea043 100%);">
                            <span class="flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                è‡ªå‹•æ›´æ–°: ON
                            </span>
                        </button>
                        <button v-else @click="toggleAutoRefresh" 
                                class="btn" style="background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);">
                            <span class="flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                è‡ªå‹•æ›´æ–°: OFF
                            </span>
                        </button>
                    </div>
                    <div v-if="lastUpdateTime" class="text-sm text-gray-400">
                        <span class="text-green-400">âœ“</span> æœ€çµ‚æ›´æ–°: {{ formatDateTime(lastUpdateTime) }}
                        <span v-if="autoRefreshEnabled" class="ml-2 text-blue-400">
                            (æ¬¡å›æ›´æ–°ã¾ã§ {{ countdown }}ç§’)
                        </span>
                    </div>
                    <div v-if="googleSheetError" class="p-3 rounded-lg" style="background: rgba(248, 81, 73, 0.1); border: 1px solid rgba(248, 81, 73, 0.3);">
                        <p class="text-red-400 text-sm">âš ï¸ {{ googleSheetError }}</p>
                    </div>
                </div>
            </div>

            <!-- CSV Upload Section -->
            <div class="card p-6">
                <h2 class="text-xl font-bold mb-4 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    ãƒˆãƒ¬ãƒ¼ãƒ‰å®Ÿç¸¾CSVèª­ã¿è¾¼ã¿ï¼ˆæ‰‹å‹•ï¼‰
                </h2>
                <div class="drop-zone" 
                     @click="fileInput.click()"
                     @dragover.prevent="isDragOver = true"
                     @dragleave.prevent="isDragOver = false"
                     @drop.prevent="handleFileDrop"
                     :class="{ 'drag-over': isDragOver }">
                    <input type="file" ref="fileInput" @change="handleFileSelect" accept=".csv" class="hidden">
                    <svg class="w-12 h-12 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <p class="text-gray-400 mb-2">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p>
                    <p class="text-sm text-gray-500">ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</p>
                    <p v-if="tradeData.length > 0" class="text-green-400 mt-4 text-sm">
                        âœ“ {{ tradeData.length }}ä»¶ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ
                    </p>
                </div>
            </div>

            <!-- Statistics Cards -->
            <div v-if="tradeData.length > 0">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="stat-card glow-green">
                        <p class="text-xs text-gray-400 mb-1">ç·ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°</p>
                        <p class="text-2xl font-bold text-white">{{ tradeStats.totalTrades }}</p>
                    </div>
                    <div class="stat-card" :class="tradeStats.winRate >= 50 ? 'glow-green' : 'glow-red'">
                        <p class="text-xs text-gray-400 mb-1">å‹ç‡ï¼ˆå»ºå€¤é™¤ãï¼‰</p>
                        <p class="text-2xl font-bold" :class="tradeStats.winRate >= 50 ? 'positive' : 'negative'">
                            {{ tradeStats.winRate.toFixed(1) }}%
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">åˆ©ç¢º</p>
                        <p class="text-2xl font-bold text-green-400">{{ tradeStats.winTrades }}</p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æåˆ‡ã‚Š</p>
                        <p class="text-2xl font-bold text-red-400">{{ tradeStats.lossTrades }}</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">å»ºå€¤æ’¤é€€</p>
                        <p class="text-2xl font-bold text-yellow-400">{{ tradeStats.breakEvenTrades }}</p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æœ‰åŠ¹ãƒˆãƒ¬ãƒ¼ãƒ‰</p>
                        <p class="text-2xl font-bold text-white">{{ tradeStats.effectiveTrades }}</p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">ãƒ—ãƒ­ãƒ•ã‚£ãƒƒãƒˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼</p>
                        <p class="text-2xl font-bold" :class="tradeStats.profitFactor >= 1 ? 'positive' : 'negative'">
                            {{ tradeStats.profitFactor.toFixed(2) }}
                        </p>
                    </div>
                    <div class="stat-card">
                        <p class="text-xs text-gray-400 mb-1">æ­£ã—ã„ãƒˆãƒ¬ãƒ¼ãƒ‰ç‡</p>
                        <p class="text-2xl font-bold text-blue-400">{{ tradeStats.correctTradeRate.toFixed(1) }}%</p>
                    </div>
                </div>

                <!-- Chart -->
                <div class="card p-6 mb-6">
                    <h3 class="text-lg font-bold mb-4">ãƒˆãƒ¬ãƒ¼ãƒ‰æ¨ç§»</h3>
                    <div class="relative" style="height: 400px;">
                        <canvas ref="resultsChartCanvas"></canvas>
                    </div>
                </div>

                <!-- Currency Pair Stats -->
                <div class="card p-6 mb-6">
                    <h3 class="text-lg font-bold mb-4">é€šè²¨ãƒšã‚¢åˆ¥æˆç¸¾</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b" style="border-color: var(--border-color);">
                                    <th class="text-left py-3 px-4 text-gray-400">é€šè²¨ãƒšã‚¢</th>
                                    <th class="text-right py-3 px-4 text-gray-400">ç·æ•°</th>
                                    <th class="text-right py-3 px-4 text-gray-400">åˆ©ç¢º</th>
                                    <th class="text-right py-3 px-4 text-gray-400">æåˆ‡ã‚Š</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å»ºå€¤</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å‹ç‡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(stats, pair) in currencyPairStats" :key="pair" 
                                    class="border-b hover:bg-gray-800" style="border-color: var(--border-color);">
                                    <td class="py-3 px-4 font-medium">{{ pair }}</td>
                                    <td class="text-right py-3 px-4">{{ stats.total }}</td>
                                    <td class="text-right py-3 px-4 text-green-400">{{ stats.win }}</td>
                                    <td class="text-right py-3 px-4 text-red-400">{{ stats.loss }}</td>
                                    <td class="text-right py-3 px-4 text-yellow-400">{{ stats.breakEven }}</td>
                                    <td class="text-right py-3 px-4" :class="stats.winRate >= 50 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.winRate.toFixed(1) }}%
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Period Stats -->
                <div class="card p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">æœŸé–“åˆ¥æˆç¸¾</h3>
                        <div class="flex gap-2" style="border-bottom: 1px solid var(--border-color);">
                            <button @click="periodView = 'monthly'"
                                    :class="['tab-btn', periodView === 'monthly' ? 'active' : '']"
                                    style="padding: 8px 16px; font-size: 14px;">
                                æœˆæ¬¡
                            </button>
                            <button @click="periodView = 'weekly'"
                                    :class="['tab-btn', periodView === 'weekly' ? 'active' : '']"
                                    style="padding: 8px 16px; font-size: 14px;">
                                é€±æ¬¡
                            </button>
                            <button @click="periodView = 'daily'"
                                    :class="['tab-btn', periodView === 'daily' ? 'active' : '']"
                                    style="padding: 8px 16px; font-size: 14px;">
                                æ—¥æ¬¡
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <!-- Monthly Stats -->
                        <table v-if="periodView === 'monthly'" class="w-full text-sm">
                            <thead>
                                <tr class="border-b" style="border-color: var(--border-color);">
                                    <th class="text-left py-3 px-4 text-gray-400">å¹´æœˆ</th>
                                    <th class="text-right py-3 px-4 text-gray-400">ç·æ•°</th>
                                    <th class="text-right py-3 px-4 text-gray-400">åˆ©ç¢º</th>
                                    <th class="text-right py-3 px-4 text-gray-400">æåˆ‡ã‚Š</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å»ºå€¤</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å‹ç‡</th>
                                    <th class="text-right py-3 px-4 text-gray-400">PF</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(stats, period) in monthlyStats" :key="period"
                                    class="border-b hover:bg-gray-800" style="border-color: var(--border-color);">
                                    <td class="py-3 px-4 font-medium">{{ period }}</td>
                                    <td class="text-right py-3 px-4">{{ stats.total }}</td>
                                    <td class="text-right py-3 px-4 text-green-400">{{ stats.win }}</td>
                                    <td class="text-right py-3 px-4 text-red-400">{{ stats.loss }}</td>
                                    <td class="text-right py-3 px-4 text-yellow-400">{{ stats.breakEven }}</td>
                                    <td class="text-right py-3 px-4" :class="stats.winRate >= 50 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.winRate.toFixed(1) }}%
                                    </td>
                                    <td class="text-right py-3 px-4" :class="stats.profitFactor >= 1 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.profitFactor.toFixed(2) }}
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Weekly Stats -->
                        <table v-if="periodView === 'weekly'" class="w-full text-sm">
                            <thead>
                                <tr class="border-b" style="border-color: var(--border-color);">
                                    <th class="text-left py-3 px-4 text-gray-400">é€±</th>
                                    <th class="text-right py-3 px-4 text-gray-400">ç·æ•°</th>
                                    <th class="text-right py-3 px-4 text-gray-400">åˆ©ç¢º</th>
                                    <th class="text-right py-3 px-4 text-gray-400">æåˆ‡ã‚Š</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å»ºå€¤</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å‹ç‡</th>
                                    <th class="text-right py-3 px-4 text-gray-400">PF</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(stats, period) in weeklyStats" :key="period"
                                    class="border-b hover:bg-gray-800" style="border-color: var(--border-color);">
                                    <td class="py-3 px-4 font-medium">{{ period }}</td>
                                    <td class="text-right py-3 px-4">{{ stats.total }}</td>
                                    <td class="text-right py-3 px-4 text-green-400">{{ stats.win }}</td>
                                    <td class="text-right py-3 px-4 text-red-400">{{ stats.loss }}</td>
                                    <td class="text-right py-3 px-4 text-yellow-400">{{ stats.breakEven }}</td>
                                    <td class="text-right py-3 px-4" :class="stats.winRate >= 50 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.winRate.toFixed(1) }}%
                                    </td>
                                    <td class="text-right py-3 px-4" :class="stats.profitFactor >= 1 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.profitFactor.toFixed(2) }}
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Daily Stats -->
                        <table v-if="periodView === 'daily'" class="w-full text-sm">
                            <thead>
                                <tr class="border-b" style="border-color: var(--border-color);">
                                    <th class="text-left py-3 px-4 text-gray-400">æ—¥ä»˜</th>
                                    <th class="text-right py-3 px-4 text-gray-400">ç·æ•°</th>
                                    <th class="text-right py-3 px-4 text-gray-400">åˆ©ç¢º</th>
                                    <th class="text-right py-3 px-4 text-gray-400">æåˆ‡ã‚Š</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å»ºå€¤</th>
                                    <th class="text-right py-3 px-4 text-gray-400">å‹ç‡</th>
                                    <th class="text-right py-3 px-4 text-gray-400">PF</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(stats, period) in dailyStats" :key="period"
                                    class="border-b hover:bg-gray-800" style="border-color: var(--border-color);">
                                    <td class="py-3 px-4 font-medium">{{ period }}</td>
                                    <td class="text-right py-3 px-4">{{ stats.total }}</td>
                                    <td class="text-right py-3 px-4 text-green-400">{{ stats.win }}</td>
                                    <td class="text-right py-3 px-4 text-red-400">{{ stats.loss }}</td>
                                    <td class="text-right py-3 px-4 text-yellow-400">{{ stats.breakEven }}</td>
                                    <td class="text-right py-3 px-4" :class="stats.winRate >= 50 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.winRate.toFixed(1) }}%
                                    </td>
                                    <td class="text-right py-3 px-4" :class="stats.profitFactor >= 1 ? 'text-green-400' : 'text-red-400'">
                                        {{ stats.profitFactor.toFixed(2) }}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Trade List -->
                <div class="card p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">ãƒˆãƒ¬ãƒ¼ãƒ‰ä¸€è¦§</h3>
                        <div class="flex gap-2">
                            <select v-model="filterCurrency" class="number-input text-sm w-32">
                                <option value="">å…¨é€šè²¨</option>
                                <option v-for="pair in uniqueCurrencies" :key="pair" :value="pair">{{ pair }}</option>
                            </select>
                            <select v-model="filterResult" class="number-input text-sm w-32">
                                <option value="">å…¨çµæœ</option>
                                <option value="åˆ©ç¢º">åˆ©ç¢º</option>
                                <option value="æåˆ‡ã‚Š">æåˆ‡ã‚Š</option>
                                <option value="å»ºå€¤æ’¤é€€">å»ºå€¤æ’¤é€€</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b" style="border-color: var(--border-color);">
                                    <th class="text-left py-3 px-4 text-gray-400">æ—¥ä»˜</th>
                                    <th class="text-left py-3 px-4 text-gray-400">é€šè²¨ãƒšã‚¢</th>
                                    <th class="text-left py-3 px-4 text-gray-400">ã‚·ãƒŠãƒªã‚ª</th>
                                    <th class="text-left py-3 px-4 text-gray-400">ã‚¨ãƒ³ãƒˆãƒªãƒ¼</th>
                                    <th class="text-center py-3 px-4 text-gray-400">çµæœ</th>
                                    <th class="text-left py-3 px-4 text-gray-400">è©•ä¾¡</th>
                                    <th class="text-left py-3 px-4 text-gray-400">ãƒ¡ãƒ¢</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(trade, index) in filteredTrades" :key="index"
                                    class="border-b hover:bg-gray-800" style="border-color: var(--border-color);">
                                    <td class="py-3 px-4">{{ formatDate(trade.date) }}</td>
                                    <td class="py-3 px-4 font-medium">{{ trade.currency }}</td>
                                    <td class="py-3 px-4 text-xs text-gray-400">{{ trade.scenario }}</td>
                                    <td class="py-3 px-4 text-xs text-gray-400">{{ trade.entryScale }}</td>
                                    <td class="text-center py-3 px-4">
                                        <span :class="{
                                            'text-green-400': trade.result === 'åˆ©ç¢º',
                                            'text-red-400': trade.result === 'æåˆ‡ã‚Š',
                                            'text-yellow-400': trade.result === 'å»ºå€¤æ’¤é€€'
                                        }" class="font-medium">
                                            {{ trade.result }}
                                        </span>
                                    </td>
                                    <td class="py-3 px-4">
                                        <span v-if="trade.correct === 'â­•ï¸'" class="text-green-400">â­•ï¸</span>
                                        <span v-else-if="trade.correct === 'âŒï¸'" class="text-red-400">âŒï¸</span>
                                        <span v-else class="text-gray-500">-</span>
                                    </td>
                                    <td class="py-3 px-4 text-xs text-gray-500 max-w-xs truncate">{{ trade.memo || '-' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div v-else class="card p-12 text-center">
                <svg class="w-16 h-16 mx-auto mb-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <p class="text-gray-400 text-lg mb-2">ãƒˆãƒ¬ãƒ¼ãƒ‰å®Ÿç¸¾ãŒã‚ã‚Šã¾ã›ã‚“</p>
                <p class="text-gray-500 text-sm">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒˆãƒ¬ãƒ¼ãƒ‰å®Ÿç¸¾ã‚’è¡¨ç¤ºã—ã¦ãã ã•ã„</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center text-gray-500 text-sm mt-8 pb-4">
            <p>FX Trading Simulator | For educational purposes only</p>
        </footer>
    </div>

    <script>
        const { createApp, ref, reactive, computed, watch, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                const chartCanvas = ref(null);
                const resultsChartCanvas = ref(null);
                const fileInput = ref(null);
                let chart = null;
                let resultsChart = null;

                const activeTab = ref('simulator');
                const isDragOver = ref(false);
                const tradeData = ref([]);
                const filterCurrency = ref('');
                const filterResult = ref('');
                const periodView = ref('monthly');
                
                // Google Sheets Integration
                const googleSheetId = ref('1WkBTJe7q7c6FhgX7CSYLKrJihwGP0KGFW2n813aLQt4');
                const googleSheetName = ref('ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒãƒ¼ãƒˆAIåˆ†æç”¨');
                const isLoadingGoogleSheets = ref(false);
                const googleSheetError = ref('');
                const autoRefreshEnabled = ref(false);
                const lastUpdateTime = ref(null);
                const countdown = ref(0);
                let autoRefreshInterval = null;
                let countdownInterval = null;

                const params = reactive({
                    accountBalance: 20000000,
                    riskRate: 0.8,
                    riskReward: 1.1,
                    monthlyTrades: 50,
                    winRate: 62.5,
                    breakEvenRate: 40,
                    profitShare: 80,
                    tradingDaysPerMonth: 20
                });

                // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚³ã‚¹ãƒˆï¼ˆå›ºå®š: å¹³å‡0.4 pipsç›¸å½“ï¼‰
                const spreadCost = 0.004;

                // æ‰‹æ•°æ–™ã‚³ã‚¹ãƒˆï¼ˆå¾€å¾©6ãƒ‰ãƒ« â‰ˆ 0.006%ï¼‰
                const commissionCost = 0.006;

                const simulation = reactive({
                    data: [],
                    finalBalance: 0,
                    maxDrawdown: 0,
                    maxDrawdownPercent: 0
                });

                const calculated = computed(() => {
                    const riskPerTrade = params.accountBalance * (params.riskRate / 100);
                    const winAmount = riskPerTrade * params.riskReward;

                    const breakEvenTrades = Math.round(params.monthlyTrades * (params.breakEvenRate / 100));
                    const effectiveTrades = params.monthlyTrades - breakEvenTrades;
                    const winTrades = Math.round(effectiveTrades * (params.winRate / 100));
                    const loseTrades = effectiveTrades - winTrades;

                    const totalWin = winTrades * winAmount;
                    const totalLoss = loseTrades * riskPerTrade;
                    const monthlyProfit = totalWin - totalLoss;
                    const monthlyReturn = (monthlyProfit / params.accountBalance) * 100;
                    const traderIncome = monthlyProfit > 0 ? monthlyProfit * (params.profitShare / 100) : monthlyProfit;

                    // æç›Šåˆ†å²å‹ç‡ = 1 / (1 + RR)
                    const breakEvenWinRate = (1 / (1 + params.riskReward)) * 100;

                    // æœ‰åŠ¹ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ãŸã‚Šã®æœŸå¾…å€¤
                    const winProb = params.winRate / 100;
                    const expectedValue = (winProb * winAmount) - ((1 - winProb) * riskPerTrade);

                    // ãƒ—ãƒ­ãƒ•ã‚£ãƒƒãƒˆãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼
                    const profitFactor = totalLoss > 0 ? totalWin / totalLoss : totalWin > 0 ? Infinity : 0;

                    return {
                        riskPerTrade: Math.round(riskPerTrade),
                        breakEvenTrades,
                        effectiveTrades,
                        winTrades,
                        loseTrades,
                        monthlyProfit: Math.round(monthlyProfit),
                        monthlyReturn,
                        traderIncome: Math.round(traderIncome),
                        breakEvenWinRate,
                        expectedValue: Math.round(expectedValue),
                        profitFactor: isFinite(profitFactor) ? profitFactor : 999
                    };
                });

                // Fintokei ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                const runFintokeiPhase = (targetPercent, iterations = 500) => {
                    const tradesPerDay = params.monthlyTrades / params.tradingDaysPerMonth;
                    const riskPerTrade = params.riskRate; // %
                    const rewardPerTrade = riskPerTrade * params.riskReward;
                    const breakEvenProb = params.breakEvenRate / 100;
                    const winProb = params.winRate / 100;

                    // ã‚³ã‚¹ãƒˆè¨ˆç®—ï¼ˆã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸ï¼‰
                    const slippageCost = () => 0.01 + Math.random() * 0.01; // 0.01-0.02%ã®ãƒ©ãƒ³ãƒ€ãƒ 

                    const results = [];
                    let successCount = 0;

                    for (let iter = 0; iter < iterations; iter++) {
                        let balance = 0; // åˆæœŸã‹ã‚‰ã®å¤‰å‹•%
                        let dayCount = 0;
                        let failed = false;
                        let succeeded = false;
                        let consecutiveLosses = 0; // é€£æ•—ã‚«ã‚¦ãƒ³ãƒˆ
                        const maxDays = 365; // æœ€å¤§1å¹´

                        while (!failed && !succeeded && dayCount < maxDays) {
                            dayCount++;
                            let dailyPnL = 0;
                            const dailyStartBalance = balance;

                            // 1æ—¥ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                            for (let t = 0; t < tradesPerDay; t++) {
                                const rand = Math.random();

                                // é€£æ•—æ™‚ã®å¿ƒç†çš„å½±éŸ¿ï¼ˆãƒªã‚¹ã‚¯å¾®å¢—ï¼‰
                                const psychologicalRiskMultiplier = 1 + (consecutiveLosses * 0.05); // é€£æ•—1å›ã”ã¨ã«+5%
                                const effectiveRisk = Math.min(riskPerTrade * psychologicalRiskMultiplier, riskPerTrade * 1.3); // æœ€å¤§+30%

                                // ç·ã‚³ã‚¹ãƒˆï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ + æ‰‹æ•°æ–™ + ã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸ï¼‰
                                const totalCost = spreadCost + commissionCost + slippageCost();

                                if (rand < breakEvenProb) {
                                    // å»ºå€¤æ’¤é€€ï¼ˆã‚³ã‚¹ãƒˆã®ã¿è² æ‹…ï¼‰
                                    dailyPnL -= totalCost;
                                    consecutiveLosses = 0;
                                } else {
                                    const adjustedRand = (rand - breakEvenProb) / (1 - breakEvenProb);
                                    if (adjustedRand < winProb) {
                                        // åˆ©ç¢ºï¼ˆã‚³ã‚¹ãƒˆå·®ã—å¼•ãï¼‰
                                        dailyPnL += (effectiveRisk * params.riskReward) - totalCost;
                                        consecutiveLosses = 0;
                                    } else {
                                        // æåˆ‡ã‚Šï¼ˆã‚³ã‚¹ãƒˆä¸Šä¹—ã›ï¼‰
                                        dailyPnL -= effectiveRisk + totalCost;
                                        consecutiveLosses++;
                                    }
                                }

                                // æ—¥ä¸­ã®ç´¯è¨ˆæå¤±ãƒã‚§ãƒƒã‚¯ï¼ˆ-5%ãƒ«ãƒ¼ãƒ«ï¼‰
                                if (dailyPnL <= -5) {
                                    failed = true;
                                    break;
                                }
                            }

                            balance += dailyPnL;

                            // å¤±æ ¼åˆ¤å®š
                            if (balance <= -10) {
                                failed = true;
                            }

                            // åˆæ ¼åˆ¤å®š
                            if (balance >= targetPercent && dayCount >= 3) {
                                succeeded = true;
                            }
                        }

                        if (succeeded) {
                            successCount++;
                            results.push(dayCount);
                        }
                    }

                    // çµ±è¨ˆè¨ˆç®—
                    results.sort((a, b) => a - b);
                    const successRate = (successCount / iterations) * 100;

                    if (results.length === 0) {
                        return {
                            successRate: 0,
                            optimistic: 999,
                            median: 999,
                            pessimistic: 999
                        };
                    }

                    const optimistic = results[Math.floor(results.length * 0.25)] || results[0];
                    const median = results[Math.floor(results.length * 0.5)] || results[0];
                    const pessimistic = results[Math.floor(results.length * 0.75)] || results[results.length - 1];

                    return {
                        successRate,
                        optimistic,
                        median,
                        pessimistic
                    };
                };

                const fintokeiMonte = computed(() => {
                    const iterations = 500;
                    const tradesPerDay = params.monthlyTrades / params.tradingDaysPerMonth;
                    const maxLossPerDay = tradesPerDay * params.riskRate;

                    // ãƒ•ã‚§ãƒ¼ã‚º1: +8%ç›®æ¨™
                    const phase1 = runFintokeiPhase(8, iterations);

                    // ãƒ•ã‚§ãƒ¼ã‚º2: +6%ç›®æ¨™
                    const phase2 = runFintokeiPhase(6, iterations);

                    // ç·åˆæˆåŠŸç‡ï¼ˆãƒ•ã‚§ãƒ¼ã‚º1æˆåŠŸ Ã— ãƒ•ã‚§ãƒ¼ã‚º2æˆåŠŸï¼‰
                    const totalSuccessRate = (phase1.successRate / 100) * (phase2.successRate / 100) * 100;

                    return {
                        iterations,
                        phase1SuccessRate: phase1.successRate,
                        phase1Optimistic: phase1.optimistic,
                        phase1Median: phase1.median,
                        phase1Pessimistic: phase1.pessimistic,
                        phase2SuccessRate: phase2.successRate,
                        phase2Optimistic: phase2.optimistic,
                        phase2Median: phase2.median,
                        phase2Pessimistic: phase2.pessimistic,
                        totalSuccessRate,
                        totalOptimistic: phase1.optimistic + phase2.optimistic,
                        totalMedian: phase1.median + phase2.median,
                        totalPessimistic: phase1.pessimistic + phase2.pessimistic,
                        dailyMaxLossPercent: maxLossPerDay
                    };
                });

                // CSV Parsing
                const parseCSV = (text) => {
                    const lines = text.split('\n').filter(line => line.trim());
                    if (lines.length < 2) return [];

                    const headers = lines[0].split(',').map(h => h.trim());
                    const trades = [];

                    for (let i = 1; i < lines.length; i++) {
                        const values = [];
                        let current = '';
                        let inQuotes = false;

                        for (let j = 0; j < lines[i].length; j++) {
                            const char = lines[i][j];
                            if (char === '"') {
                                inQuotes = !inQuotes;
                            } else if (char === ',' && !inQuotes) {
                                values.push(current.trim());
                                current = '';
                            } else {
                                current += char;
                            }
                        }
                        values.push(current.trim());

                        if (values.length >= headers.length) {
                            const trade = {
                                date: values[0] || '',
                                entryTime: values[1] || '',
                                exitTime: values[2] || '',
                                currency: values[3] || '',
                                scenario: values[4] || '',
                                entryScale: values[5] || '',
                                result: values[6] || '',
                                scenarioDetail: values[7] || '',
                                exitCriteria: values[8] || '',
                                correct: values[9] || '',
                                memo: values[10] || ''
                            };
                            trades.push(trade);
                        }
                    }

                    return trades;
                };

                const handleFileSelect = (event) => {
                    const file = event.target.files[0];
                    if (file && file.type === 'text/csv' || file.name.endsWith('.csv')) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const text = e.target.result;
                            tradeData.value = parseCSV(text);
                            nextTick(() => {
                                updateResultsChart();
                            });
                        };
                        reader.readAsText(file, 'UTF-8');
                    }
                };

                const handleFileDrop = (event) => {
                    isDragOver.value = false;
                    const file = event.dataTransfer.files[0];
                    if (file && (file.type === 'text/csv' || file.name.endsWith('.csv'))) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const text = e.target.result;
                            tradeData.value = parseCSV(text);
                            googleSheetError.value = '';
                            nextTick(() => {
                                updateResultsChart();
                            });
                        };
                        reader.readAsText(file, 'UTF-8');
                    }
                };

                // Google Sheets Integration
                const loadFromGoogleSheets = async () => {
                    if (!googleSheetId.value || !googleSheetName.value) {
                        googleSheetError.value = 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã¨ã‚·ãƒ¼ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
                        return;
                    }

                    isLoadingGoogleSheets.value = true;
                    googleSheetError.value = '';

                    try {
                        // Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆURL
                        // å…¬é–‹ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å ´åˆã€ã“ã®URLã§ç›´æ¥CSVã‚’å–å¾—å¯èƒ½
                        const sheetNameEncoded = encodeURIComponent(googleSheetName.value);
                        const url = `https://docs.google.com/spreadsheets/d/${googleSheetId.value}/gviz/tq?tqx=out:csv&sheet=${sheetNameEncoded}`;
                        
                        const response = await fetch(url);
                        
                        if (!response.ok) {
                            throw new Error(`HTTPã‚¨ãƒ©ãƒ¼: ${response.status} - ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒå…¬é–‹è¨­å®šã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„`);
                        }

                        const text = await response.text();
                        
                        if (!text || text.trim().length === 0) {
                            throw new Error('ãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™ã€‚ã‚·ãƒ¼ãƒˆåãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„');
                        }

                        tradeData.value = parseCSV(text);
                        lastUpdateTime.value = new Date();
                        googleSheetError.value = '';
                        
                        nextTick(() => {
                            updateResultsChart();
                        });
                    } catch (error) {
                        console.error('Google Sheetsèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                        googleSheetError.value = error.message || 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒå…¬é–‹è¨­å®šï¼ˆãƒªãƒ³ã‚¯ã‚’çŸ¥ã£ã¦ã„ã‚‹å…¨å“¡ãŒé–²è¦§å¯ï¼‰ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
                    } finally {
                        isLoadingGoogleSheets.value = false;
                    }
                };

                const toggleAutoRefresh = () => {
                    autoRefreshEnabled.value = !autoRefreshEnabled.value;
                    
                    if (autoRefreshEnabled.value) {
                        // è‡ªå‹•æ›´æ–°ã‚’é–‹å§‹ï¼ˆ30ç§’ã”ã¨ï¼‰
                        autoRefreshInterval = setInterval(() => {
                            if (googleSheetId.value && googleSheetName.value) {
                                loadFromGoogleSheets();
                            }
                        }, 30000);
                        
                        // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤º
                        countdown.value = 30;
                        countdownInterval = setInterval(() => {
                            countdown.value--;
                            if (countdown.value <= 0) {
                                countdown.value = 30;
                            }
                        }, 1000);
                    } else {
                        // è‡ªå‹•æ›´æ–°ã‚’åœæ­¢
                        if (autoRefreshInterval) {
                            clearInterval(autoRefreshInterval);
                            autoRefreshInterval = null;
                        }
                        if (countdownInterval) {
                            clearInterval(countdownInterval);
                            countdownInterval = null;
                        }
                        countdown.value = 0;
                    }
                };

                const formatDateTime = (date) => {
                    if (!date) return '';
                    return date.toLocaleString('ja-JP', { 
                        year: 'numeric', 
                        month: '2-digit', 
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
                };

                // Trade Statistics
                const tradeStats = computed(() => {
                    if (tradeData.value.length === 0) {
                        return {
                            totalTrades: 0,
                            winTrades: 0,
                            lossTrades: 0,
                            breakEvenTrades: 0,
                            effectiveTrades: 0,
                            winRate: 0,
                            profitFactor: 0,
                            correctTradeRate: 0
                        };
                    }

                    const winTrades = tradeData.value.filter(t => t.result === 'åˆ©ç¢º').length;
                    const lossTrades = tradeData.value.filter(t => t.result === 'æåˆ‡ã‚Š').length;
                    const breakEvenTrades = tradeData.value.filter(t => t.result === 'å»ºå€¤æ’¤é€€').length;
                    const effectiveTrades = winTrades + lossTrades;
                    const winRate = effectiveTrades > 0 ? (winTrades / effectiveTrades) * 100 : 0;
                    const profitFactor = lossTrades > 0 ? winTrades / lossTrades : winTrades > 0 ? Infinity : 0;
                    const correctTrades = tradeData.value.filter(t => t.correct === 'â­•ï¸').length;
                    const correctTradeRate = tradeData.value.length > 0 ? (correctTrades / tradeData.value.length) * 100 : 0;

                    return {
                        totalTrades: tradeData.value.length,
                        winTrades,
                        lossTrades,
                        breakEvenTrades,
                        effectiveTrades,
                        winRate,
                        profitFactor: isFinite(profitFactor) ? profitFactor : 999,
                        correctTradeRate
                    };
                });

                // Currency Pair Statistics
                const currencyPairStats = computed(() => {
                    const stats = {};
                    tradeData.value.forEach(trade => {
                        if (!stats[trade.currency]) {
                            stats[trade.currency] = {
                                total: 0,
                                win: 0,
                                loss: 0,
                                breakEven: 0,
                                winRate: 0
                            };
                        }
                        stats[trade.currency].total++;
                        if (trade.result === 'åˆ©ç¢º') stats[trade.currency].win++;
                        else if (trade.result === 'æåˆ‡ã‚Š') stats[trade.currency].loss++;
                        else if (trade.result === 'å»ºå€¤æ’¤é€€') stats[trade.currency].breakEven++;
                    });

                    Object.keys(stats).forEach(pair => {
                        const effective = stats[pair].win + stats[pair].loss;
                        stats[pair].winRate = effective > 0 ? (stats[pair].win / effective) * 100 : 0;
                    });

                    return stats;
                });

                // Unique Currencies
                const uniqueCurrencies = computed(() => {
                    const currencies = new Set(tradeData.value.map(t => t.currency));
                    return Array.from(currencies).sort();
                });

                // Helper function to get week key (ISO week)
                const getWeekKey = (date) => {
                    const d = new Date(date);
                    d.setHours(0, 0, 0, 0);
                    d.setDate(d.getDate() + 3 - (d.getDay() + 6) % 7);
                    const week1 = new Date(d.getFullYear(), 0, 4);
                    const weekNum = Math.ceil((((d - week1) / 86400000) + week1.getDay() + 1) / 7);
                    const year = d.getFullYear();
                    return `${year}å¹´ ç¬¬${weekNum}é€±`;
                };

                // Monthly Statistics
                const monthlyStats = computed(() => {
                    const stats = {};
                    tradeData.value.forEach(trade => {
                        const date = parseDate(trade.date);
                        if (!date) return;
                        
                        const monthKey = `${date.getFullYear()}å¹´${date.getMonth() + 1}æœˆ`;
                        if (!stats[monthKey]) {
                            stats[monthKey] = {
                                total: 0,
                                win: 0,
                                loss: 0,
                                breakEven: 0,
                                winRate: 0,
                                profitFactor: 0
                            };
                        }
                        stats[monthKey].total++;
                        if (trade.result === 'åˆ©ç¢º') stats[monthKey].win++;
                        else if (trade.result === 'æåˆ‡ã‚Š') stats[monthKey].loss++;
                        else if (trade.result === 'å»ºå€¤æ’¤é€€') stats[monthKey].breakEven++;
                    });

                    Object.keys(stats).forEach(month => {
                        const effective = stats[month].win + stats[month].loss;
                        stats[month].winRate = effective > 0 ? (stats[month].win / effective) * 100 : 0;
                        stats[month].profitFactor = stats[month].loss > 0 ? stats[month].win / stats[month].loss : stats[month].win > 0 ? Infinity : 0;
                        if (!isFinite(stats[month].profitFactor)) stats[month].profitFactor = 999;
                    });

                    // Sort by date descending
                    return Object.keys(stats).sort((a, b) => {
                        const matchA = a.match(/(\d+)å¹´(\d+)/);
                        const matchB = b.match(/(\d+)å¹´(\d+)/);
                        if (!matchA || !matchB) return 0;
                        const yearA = parseInt(matchA[1]);
                        const monthA = parseInt(matchA[2]);
                        const yearB = parseInt(matchB[1]);
                        const monthB = parseInt(matchB[2]);
                        if (yearA !== yearB) return yearB - yearA;
                        return monthB - monthA;
                    }).reduce((sorted, key) => {
                        sorted[key] = stats[key];
                        return sorted;
                    }, {});
                });

                // Weekly Statistics
                const weeklyStats = computed(() => {
                    const stats = {};
                    tradeData.value.forEach(trade => {
                        const date = parseDate(trade.date);
                        if (!date) return;
                        
                        const weekKey = getWeekKey(date);
                        if (!stats[weekKey]) {
                            stats[weekKey] = {
                                total: 0,
                                win: 0,
                                loss: 0,
                                breakEven: 0,
                                winRate: 0,
                                profitFactor: 0
                            };
                        }
                        stats[weekKey].total++;
                        if (trade.result === 'åˆ©ç¢º') stats[weekKey].win++;
                        else if (trade.result === 'æåˆ‡ã‚Š') stats[weekKey].loss++;
                        else if (trade.result === 'å»ºå€¤æ’¤é€€') stats[weekKey].breakEven++;
                    });

                    Object.keys(stats).forEach(week => {
                        const effective = stats[week].win + stats[week].loss;
                        stats[week].winRate = effective > 0 ? (stats[week].win / effective) * 100 : 0;
                        stats[week].profitFactor = stats[week].loss > 0 ? stats[week].win / stats[week].loss : stats[week].win > 0 ? Infinity : 0;
                        if (!isFinite(stats[week].profitFactor)) stats[week].profitFactor = 999;
                    });

                    // Sort by date descending
                    return Object.keys(stats).sort((a, b) => {
                        const matchA = a.match(/(\d+)å¹´\s*ç¬¬(\d+)/);
                        const matchB = b.match(/(\d+)å¹´\s*ç¬¬(\d+)/);
                        if (!matchA || !matchB) return 0;
                        const yearA = parseInt(matchA[1]);
                        const weekA = parseInt(matchA[2]);
                        const yearB = parseInt(matchB[1]);
                        const weekB = parseInt(matchB[2]);
                        if (yearA !== yearB) return yearB - yearA;
                        return weekB - weekA;
                    }).reduce((sorted, key) => {
                        sorted[key] = stats[key];
                        return sorted;
                    }, {});
                });

                // Daily Statistics
                const dailyStats = computed(() => {
                    const stats = {};
                    tradeData.value.forEach(trade => {
                        const date = parseDate(trade.date);
                        if (!date) return;
                        
                        const dayKey = date.toLocaleDateString('ja-JP', { year: 'numeric', month: '2-digit', day: '2-digit' });
                        if (!stats[dayKey]) {
                            stats[dayKey] = {
                                total: 0,
                                win: 0,
                                loss: 0,
                                breakEven: 0,
                                winRate: 0,
                                profitFactor: 0
                            };
                        }
                        stats[dayKey].total++;
                        if (trade.result === 'åˆ©ç¢º') stats[dayKey].win++;
                        else if (trade.result === 'æåˆ‡ã‚Š') stats[dayKey].loss++;
                        else if (trade.result === 'å»ºå€¤æ’¤é€€') stats[dayKey].breakEven++;
                    });

                    Object.keys(stats).forEach(day => {
                        const effective = stats[day].win + stats[day].loss;
                        stats[day].winRate = effective > 0 ? (stats[day].win / effective) * 100 : 0;
                        stats[day].profitFactor = stats[day].loss > 0 ? stats[day].win / stats[day].loss : stats[day].win > 0 ? Infinity : 0;
                        if (!isFinite(stats[day].profitFactor)) stats[day].profitFactor = 999;
                    });

                    // Sort by date descending
                    return Object.keys(stats).sort((a, b) => {
                        // dayKey format: "2025/12/03"
                        const dateA = new Date(a.replace(/\//g, '-'));
                        const dateB = new Date(b.replace(/\//g, '-'));
                        if (isNaN(dateA.getTime()) || isNaN(dateB.getTime())) return 0;
                        return dateB - dateA;
                    }).reduce((sorted, key) => {
                        sorted[key] = stats[key];
                        return sorted;
                    }, {});
                });

                // Filtered Trades
                const filteredTrades = computed(() => {
                    let filtered = [...tradeData.value];
                    if (filterCurrency.value) {
                        filtered = filtered.filter(t => t.currency === filterCurrency.value);
                    }
                    if (filterResult.value) {
                        filtered = filtered.filter(t => t.result === filterResult.value);
                    }
                    return filtered.reverse(); // æœ€æ–°é †
                });

                const parseDate = (dateStr) => {
                    if (!dateStr) return null;
                    // Handle "2025/12/03 17:00:00" format
                    const datePart = dateStr.split(' ')[0];
                    const date = new Date(datePart.replace(/\//g, '-'));
                    return isNaN(date.getTime()) ? null : date;
                };

                const formatDate = (dateStr) => {
                    const date = parseDate(dateStr);
                    if (!date) return dateStr || '-';
                    return date.toLocaleDateString('ja-JP', { year: 'numeric', month: '2-digit', day: '2-digit' });
                };

                const formatCurrency = (value) => {
                    if (Math.abs(value) >= 100000000) {
                        return (value / 100000000).toFixed(2) + 'å„„å††';
                    } else if (Math.abs(value) >= 10000) {
                        return (value / 10000).toFixed(1) + 'ä¸‡å††';
                    }
                    return value.toLocaleString('ja-JP') + 'å††';
                };

                const updateAccountBalance = (e) => {
                    const value = e.target.value.replace(/[^0-9]/g, '');
                    if (value) {
                        params.accountBalance = parseInt(value);
                    }
                };

                const runSimulation = () => {
                    const riskPerTrade = params.accountBalance * (params.riskRate / 100);
                    const winAmount = riskPerTrade * params.riskReward;

                    // ã‚³ã‚¹ãƒˆè¨ˆç®—ï¼ˆå¹³å‡ã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸å«ã‚€ï¼‰
                    const totalCostPercent = spreadCost + commissionCost + 0.015; // å¹³å‡ã‚¹ãƒªãƒƒãƒšãƒ¼ã‚¸

                    let balance = params.accountBalance;
                    let peak = balance;
                    let maxDrawdown = 0;
                    let maxDrawdownPercent = 0;
                    const data = [balance];

                    for (let i = 0; i < params.monthlyTrades; i++) {
                        const rand = Math.random() * 100;
                        const costInYen = params.accountBalance * (totalCostPercent / 100);

                        if (rand < params.breakEvenRate) {
                            // å»ºå€¤æ’¤é€€ - ã‚³ã‚¹ãƒˆã®ã¿è² æ‹…
                            balance -= costInYen;
                        } else {
                            const adjustedRand = (rand - params.breakEvenRate) / (100 - params.breakEvenRate) * 100;
                            if (adjustedRand < params.winRate) {
                                // åˆ©ç¢º - ã‚³ã‚¹ãƒˆå·®ã—å¼•ã
                                balance += winAmount - costInYen;
                            } else {
                                // æåˆ‡ã‚Š - ã‚³ã‚¹ãƒˆä¸Šä¹—ã›
                                balance -= riskPerTrade + costInYen;
                            }
                        }

                        data.push(Math.round(balance));

                        if (balance > peak) {
                            peak = balance;
                        }
                        const drawdown = peak - balance;
                        const drawdownPercent = (drawdown / peak) * 100;
                        if (drawdown > maxDrawdown) {
                            maxDrawdown = drawdown;
                            maxDrawdownPercent = drawdownPercent;
                        }
                    }

                    simulation.data = data;
                    simulation.finalBalance = Math.round(balance);
                    simulation.maxDrawdown = maxDrawdown;
                    simulation.maxDrawdownPercent = maxDrawdownPercent;

                    updateChart();
                };

                const updateChart = () => {
                    if (!chart || !chartCanvas.value) return;

                    const labels = simulation.data.map((_, i) => i === 0 ? 'é–‹å§‹' : `${i}å›ç›®`);
                    const startBalance = params.accountBalance;

                    // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ
                    const ctx = chartCanvas.value.getContext('2d');
                    const gradient = ctx.createLinearGradient(0, 0, 0, 400);
                    if (simulation.finalBalance >= startBalance) {
                        gradient.addColorStop(0, 'rgba(63, 185, 80, 0.3)');
                        gradient.addColorStop(1, 'rgba(63, 185, 80, 0)');
                    } else {
                        gradient.addColorStop(0, 'rgba(248, 81, 73, 0.3)');
                        gradient.addColorStop(1, 'rgba(248, 81, 73, 0)');
                    }

                    chart.data.labels = labels;
                    chart.data.datasets[0].data = simulation.data;
                    chart.data.datasets[0].backgroundColor = gradient;
                    chart.data.datasets[0].borderColor = simulation.finalBalance >= startBalance ? '#3fb950' : '#f85149';
                    chart.data.datasets[1].data = new Array(simulation.data.length).fill(startBalance);
                    chart.update('none');
                };

                const initChart = () => {
                    if (!chartCanvas.value) return;

                    const ctx = chartCanvas.value.getContext('2d');

                    chart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: 'è³‡ç”£æ¨ç§»',
                                    data: [],
                                    borderColor: '#3fb950',
                                    backgroundColor: 'rgba(63, 185, 80, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.1,
                                    pointRadius: 0,
                                    pointHoverRadius: 6,
                                    pointHoverBackgroundColor: '#3fb950'
                                },
                                {
                                    label: 'åˆæœŸè³‡é‡‘',
                                    data: [],
                                    borderColor: '#8b949e',
                                    borderWidth: 1,
                                    borderDash: [5, 5],
                                    fill: false,
                                    pointRadius: 0,
                                    pointHoverRadius: 0
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        color: '#8b949e',
                                        usePointStyle: true,
                                        padding: 20
                                    }
                                },
                                tooltip: {
                                    backgroundColor: '#21262d',
                                    titleColor: '#e6edf3',
                                    bodyColor: '#e6edf3',
                                    borderColor: '#30363d',
                                    borderWidth: 1,
                                    padding: 12,
                                    displayColors: false,
                                    callbacks: {
                                        label: function(context) {
                                            if (context.datasetIndex === 0) {
                                                const value = context.raw;
                                                const diff = value - params.accountBalance;
                                                const diffPercent = (diff / params.accountBalance * 100).toFixed(2);
                                                const sign = diff >= 0 ? '+' : '';
                                                return [
                                                    `è³‡ç”£: Â¥${value.toLocaleString()}`,
                                                    `æç›Š: ${sign}Â¥${diff.toLocaleString()} (${sign}${diffPercent}%)`
                                                ];
                                            }
                                            return null;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        color: 'rgba(48, 54, 61, 0.5)',
                                        drawBorder: false
                                    },
                                    ticks: {
                                        color: '#8b949e',
                                        maxTicksLimit: 10
                                    }
                                },
                                y: {
                                    grid: {
                                        color: 'rgba(48, 54, 61, 0.5)',
                                        drawBorder: false
                                    },
                                    ticks: {
                                        color: '#8b949e',
                                        callback: function(value) {
                                            if (value >= 100000000) {
                                                return (value / 100000000).toFixed(1) + 'å„„';
                                            } else if (value >= 10000) {
                                                return (value / 10000).toFixed(0) + 'ä¸‡';
                                            }
                                            return value;
                                        }
                                    }
                                }
                            }
                        }
                    });

                    runSimulation();
                };

                // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´æ™‚ã®è‡ªå‹•å†è¨ˆç®—
                watch(
                    () => [
                        params.accountBalance,
                        params.riskRate,
                        params.riskReward,
                        params.monthlyTrades,
                        params.winRate,
                        params.breakEvenRate,
                        params.profitShare,
                        params.tradingDaysPerMonth
                    ],
                    () => {
                        runSimulation();
                    },
                    { deep: true }
                );

                // Results Chart
                const initResultsChart = () => {
                    if (!resultsChartCanvas.value) return;

                    const ctx = resultsChartCanvas.value.getContext('2d');
                    resultsChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: 'ç´¯ç©å‹ç‡',
                                    data: [],
                                    borderColor: '#58a6ff',
                                    backgroundColor: 'rgba(88, 166, 255, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.1,
                                    yAxisID: 'y',
                                    pointRadius: 0,
                                    pointHoverRadius: 6
                                },
                                {
                                    label: 'ç´¯ç©ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°',
                                    data: [],
                                    borderColor: '#8b949e',
                                    backgroundColor: 'rgba(139, 148, 158, 0.1)',
                                    borderWidth: 1,
                                    fill: false,
                                    tension: 0.1,
                                    yAxisID: 'y1',
                                    pointRadius: 0,
                                    pointHoverRadius: 4
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        color: '#8b949e',
                                        usePointStyle: true,
                                        padding: 20
                                    }
                                },
                                tooltip: {
                                    backgroundColor: '#21262d',
                                    titleColor: '#e6edf3',
                                    bodyColor: '#e6edf3',
                                    borderColor: '#30363d',
                                    borderWidth: 1,
                                    padding: 12
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        color: 'rgba(48, 54, 61, 0.5)',
                                        drawBorder: false
                                    },
                                    ticks: {
                                        color: '#8b949e',
                                        maxTicksLimit: 20
                                    }
                                },
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    grid: {
                                        color: 'rgba(48, 54, 61, 0.5)',
                                        drawBorder: false
                                    },
                                    ticks: {
                                        color: '#8b949e',
                                        callback: function(value) {
                                            return value.toFixed(1) + '%';
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'å‹ç‡ (%)',
                                        color: '#8b949e'
                                    }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    grid: {
                                        drawOnChartArea: false
                                    },
                                    ticks: {
                                        color: '#8b949e'
                                    },
                                    title: {
                                        display: true,
                                        text: 'ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°',
                                        color: '#8b949e'
                                    }
                                }
                            }
                        }
                    });
                };

                const updateResultsChart = () => {
                    if (!resultsChart || tradeData.value.length === 0) return;

                    const sortedTrades = [...tradeData.value].sort((a, b) => {
                        const dateA = parseDate(a.date);
                        const dateB = parseDate(b.date);
                        if (!dateA || !dateB) return 0;
                        return dateA - dateB;
                    });

                    let winCount = 0;
                    let lossCount = 0;
                    let totalCount = 0;
                    const winRateData = [];
                    const tradeCountData = [];
                    const labels = [];

                    sortedTrades.forEach((trade, index) => {
                        totalCount++;
                        if (trade.result === 'åˆ©ç¢º') winCount++;
                        else if (trade.result === 'æåˆ‡ã‚Š') lossCount++;

                        const effective = winCount + lossCount;
                        const winRate = effective > 0 ? (winCount / effective) * 100 : 0;
                        winRateData.push(winRate);
                        tradeCountData.push(totalCount);
                        labels.push(`${index + 1}å›ç›®`);
                    });

                    resultsChart.data.labels = labels;
                    resultsChart.data.datasets[0].data = winRateData;
                    resultsChart.data.datasets[1].data = tradeCountData;
                    resultsChart.update('none');
                };

                watch(() => tradeData.value.length, () => {
                    if (tradeData.value.length > 0) {
                        nextTick(() => {
                            if (!resultsChart) {
                                initResultsChart();
                            }
                            updateResultsChart();
                        });
                    }
                });

                // Cleanup intervals when switching tabs
                watch(() => activeTab.value, (newTab) => {
                    if (newTab !== 'results' && autoRefreshEnabled.value) {
                        toggleAutoRefresh();
                    }
                });

                onMounted(() => {
                    nextTick(() => {
                        initChart();
                        initResultsChart();
                    });
                });

                return {
                    chartCanvas,
                    resultsChartCanvas,
                    fileInput,
                    activeTab,
                    isDragOver,
                    tradeData,
                    filterCurrency,
                    filterResult,
                    periodView,
                    googleSheetId,
                    googleSheetName,
                    isLoadingGoogleSheets,
                    googleSheetError,
                    autoRefreshEnabled,
                    lastUpdateTime,
                    countdown,
                    params,
                    calculated,
                    simulation,
                    fintokeiMonte,
                    tradeStats,
                    currencyPairStats,
                    monthlyStats,
                    weeklyStats,
                    dailyStats,
                    uniqueCurrencies,
                    filteredTrades,
                    formatCurrency,
                    formatDate,
                    formatDateTime,
                    updateAccountBalance,
                    runSimulation,
                    handleFileSelect,
                    handleFileDrop,
                    loadFromGoogleSheets,
                    toggleAutoRefresh
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
